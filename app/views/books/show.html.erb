<div class="container my-5">
  <%= link_to books_path, class: "text-decoration-none text-muted" do %>
    <i class="fa-solid fa-arrow-left-long"></i>
    Return
  <% end %>
  <div class="row justify-content-center mb-3">
    <div class="col-md-4">
      <% if @book.photo.attached? %>
        <%= cl_image_tag @book.photo.key, class: "img-fluid d-block mx-auto", height: "300px", width: "300px", crop: :fill %>
      <% else %>
        <%= image_tag "livro.jpeg", class: "img-fluid d-block mx-auto", height: "300px", width: "300px" %>
      <% end %>
      <% if current_user && current_user.name == @book.user.name %>
        <p class="d-block text-muted text-center">This book belongs to <span class="fw-bold">you</span></p>
      <% else %>
        <p class="d-block text-muted text-center">This book belongs to <span class="fw-bold"><%= @book.user.name %></span></p>
      <% end %>
    </div>
    <div class="col-md-5 mb-5 mb-md-0">
      <span class="badge rounded-pill text-bg-success text-white"><%= @book.genre.capitalize %></span>
      <h1><%= @book.title %>
        <span class="fs-5">(<%= @book.year %>)<span>
      </h1>
      <p class="mb-4">By
        <span class="fw-bold"><%= @book.author.capitalize %></span>
      </p>
      <% if current_user == @book.user %>
        <%= link_to edit_book_path(@book), class: "btn btn-outline-secondary me-3" do %>
          <i class="fa-solid fa-pen-to-square me-2"></i>
          Edit offer
        <% end %>
        <%= link_to profile_path, class: "btn btn-outline-danger", data: {turbo_method: :delete, turbo_confirm: "Are you sure?" } do %>
          <i class="fa-solid fa-trash-can me"></i>
          Delete offer
        <% end %>
      <% else %>
        <% if @book.available %>
          <div class="card bg-light border-0 rounded-0 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">Would you like to borrow it?</h5>
              <%= simple_form_for [@book, @trade] do |f| %>
                <%= f.input :trade_date, as: :date %>
                <%= f.input :return_date, as: :date %>
                <%= f.button :submit, class: "btn btn-warning d-block w-100" %>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
    <div class="col-md-9">
      <h5>This book is sent from:</h5>
      <div class="mx-auto" style="width: 100%; height: 300px;" data-controller="map" data-map-markers-value="<%= @markers.to_json %>" data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
    </div>
  </div>
</div>
